package blt.java.disciplina.view;

import javafx.fxml.FXML;



import java.sql.SQLException;
import java.util.List;


import blt.java.disciplina.ManutencaoDisciplinas;
import blt.java.disciplina.jdbc.DisciplinaDao;
import blt.java.disciplina.model.Disciplina;
import javafx.scene.control.Alert;
import javafx.scene.control.Alert.AlertType;

/**
*
* @author Torres
*/

public class DisciplinaVisaoGeralControlador {
    
    private ManutencaoDisciplinas mainApp; // Referencia à aplicação principal.
    DisciplinaDao bd = new DisciplinaDao(); //Abre conexão com BD.
    
    
    //Construtor
    public DisciplinaVisaoGeralControlador() {
    }

    /**
     * Chamado quando o usuário clica no botão adicionar abre uma janela para editar
     * detalhes da nova pessoa.
     * @throws SQLException
     */
    @FXML
    private void botaoNovaDisciplina()  {
        Disciplina tempDisciplina = new Disciplina();

        boolean okClicked = mainApp.mostrarDisciplinaCaixaEditar(tempDisciplina);
        if (okClicked) {
            bd.adiciona(tempDisciplina);
            Alert alert = new Alert(AlertType.ERROR);
                      alert.setTitle("Disciplina criada!");
                      alert.setHeaderText("Disciplina criada!");
                      alert.setContentText("A nova disciplina foi adicionada ao banco de dados.!");
                      alert.showAndWait();
        }
    }
    
    /**
     * Chamado quando o usuário clica no botão editar abre a janela para pesquisar
     * uma pessoa a ser editada.
     */
    @FXML
   private void botaoEditarDisciplina() {
    	Disciplina tempDisciplina = new Disciplina();
        Disciplina tempDisciplina2 = new Disciplina();
        boolean existeDisciplina = false;
        
        boolean okClicked = mainApp.mostrarDisciplinaPesquisar(tempDisciplina2);
        if(okClicked){
    	List<Disciplina> disciplinas = bd.getLista();

		for (Disciplina disciplina : disciplinas) {
			if(tempDisciplina2.getNome().equals(disciplina.getNome()) ){
				tempDisciplina = disciplina;
                                existeDisciplina = true;
			}
		}
                
                if(existeDisciplina){
                    boolean okClicked1 = mainApp.mostrarDisciplinaAlterar(tempDisciplina);
                        if(okClicked1){
                            bd.altera(tempDisciplina, tempDisciplina2.getNome());
                            Alert alert = new Alert(AlertType.ERROR);
                                alert.setTitle("Disciplina alterada!");
                                alert.setHeaderText("Disciplina encontrada!");
                                alert.setContentText("A disciplina foi alterada com sucesso!");
                                alert.showAndWait();
                        }
                }else{
                    Alert alert = new Alert(AlertType.ERROR);
                      alert.setTitle("Nome Inválido");
                      alert.setHeaderText("Disciplina não encontrada!");
                      alert.setContentText("Por favor, visualize os nomes das disciplinas e tente novamente.");
                      alert.showAndWait();
                }
        }
    }

    @FXML
    private void botaoDeletarDisciplina() {
    	Disciplina tempDisciplina = new Disciplina();
        Disciplina tempDisciplina2 = new Disciplina();
    	boolean existeDisciplina = false;
        
        boolean okClicked = mainApp.mostrarDisciplinaPesquisar(tempDisciplina2);
        if(okClicked){

    	List<Disciplina> disciplinas = bd.getLista();

		for (Disciplina disciplina : disciplinas) {
			if(tempDisciplina2.getNome().equals( disciplina.getNome() )){
				tempDisciplina = disciplina;
                                existeDisciplina = true;
			}
		}
                
                if(existeDisciplina){
			bd.remove(tempDisciplina);
                        Alert alert = new Alert(AlertType.ERROR);
                                alert.setTitle("Disciplina removida!");
                                alert.setHeaderText("Disciplina encontrada!");
                                alert.setContentText("A disciplina foi removida com sucesso!");
                                alert.showAndWait();
                }else{
                    Alert alert = new Alert(AlertType.ERROR);
                      alert.setTitle("Nome Inválido");
                      alert.setHeaderText("Disciplina não encontrada!");
                      alert.setContentText("Por favor, visualize os nomes das disciplinas e tente novamente.");
                      alert.showAndWait();
                }
        }

    }

    @FXML
    private void botaoVisualizarDisciplina()  {

        mainApp.mostrarDisciplinasVisualizar();

    }

    /**
     * É chamado pela aplicação principal para dar uma referência de volta a si mesmo.
     *
     * @param mainApp
     */
    public void setMainApp(ManutencaoDisciplinas mainApp) {
        this.mainApp = mainApp;

    }
}

